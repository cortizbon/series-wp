---
title: "Contagio financiero a través del Índice de contagio"
author: "Carlos Ortiz"
format: pdf
editor: visual
fontsize: 10pt
---

```{r}
# leer los datos
library(readr)
library(reshape2)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(moments)
library(tseries)
library(ConnectednessApproach)
library(zoo)
library(kableExtra)
library(vars)

rets <- read_csv("~/series-wp/exchange_rates_returns.csv")
vals <- read_csv("~/series-wp/exchange_rates_values.csv")

rets <- dplyr::select(rets, -c(PAB))
vals <- dplyr::select(vals, -c(PAB))

# graficar los datos

vals$Date <- as.Date(vals$Date)
rets$Date <- as.Date(rets$Date)


vals_long <- melt(vals, id.vars = "Date", variable.name = "Series", value.name = "Value")
```


## Resumen

**Palabras clave**:

## Abstract

**Keywords**:

\newpage

## Introducción

Contexto histórico sobre el mercado financiero

Combinación histórica y estudios sobre el mercado financiero

Relevancia del estudio del contagio financiero y mención a algunas fuentes

Objetivo del proyecto

Estructura

## Revisión de literatura

Mercado bursátil

Contagio financiero

Diebold-Yilmaz

## Datos


```{r}
ggplot(vals_long, aes(x = Date, y = Value)) +
  geom_line() +
  facet_wrap(~ Series, nrow = 4, ncol = 4, scales = "free_y") +
  theme_minimal() +
  labs(title = "Time Series Grid", x = "Date", y = "Value")
```

```{r}
series_names <- c("ARS", "BRL", "CLP", "COP", "CRC", "DOP",
                  "GTQ", "HNL", "MXN", "NIO", "PEN", "PYG", "UYU")

stats <- data.frame(
  Statistic = c("Mean", "Variance", "Min", "Max", "Median", "Skewness", "Kurtosis"),
  ARS = c(mean(vals$ARS), var(vals$ARS), min(vals$ARS), max(vals$ARS), median(vals$ARS), skewness(vals$ARS), kurtosis(vals$ARS)),
  BRL = c(mean(vals$BRL), var(vals$BRL), min(vals$BRL), max(vals$BRL), median(vals$BRL), skewness(vals$BRL), kurtosis(vals$BRL)),
  CLP = c(mean(vals$CLP), var(vals$CLP), min(vals$CLP), max(vals$CLP), median(vals$CLP), skewness(vals$CLP), kurtosis(vals$CLP)),
  COP = c(mean(vals$COP), var(vals$COP), min(vals$COP), max(vals$COP), median(vals$COP), skewness(vals$COP), kurtosis(vals$COP)),
  CRC = c(mean(vals$CRC), var(vals$CRC), min(vals$CRC), max(vals$CRC), median(vals$CRC), skewness(vals$CRC), kurtosis(vals$CRC)),
  DOP = c(mean(vals$DOP), var(vals$DOP), min(vals$DOP), max(vals$DOP), median(vals$DOP), skewness(vals$DOP), kurtosis(vals$DOP)),
  GTQ = c(mean(vals$GTQ), var(vals$GTQ), min(vals$GTQ), max(vals$GTQ), median(vals$GTQ), skewness(vals$GTQ), kurtosis(vals$GTQ)),
  HNL = c(mean(vals$HNL), var(vals$HNL), min(vals$HNL), max(vals$HNL), median(vals$HNL), skewness(vals$HNL), kurtosis(vals$HNL)),
  MXN = c(mean(vals$MXN), var(vals$MXN), min(vals$MXN), max(vals$MXN), median(vals$MXN), skewness(vals$MXN), kurtosis(vals$MXN)),
  NIO = c(mean(vals$NIO), var(vals$NIO), min(vals$NIO), max(vals$NIO), median(vals$NIO), skewness(vals$NIO), kurtosis(vals$NIO)),
  PEN = c(mean(vals$PEN), var(vals$PEN), min(vals$PEN), max(vals$PEN), median(vals$PEN), skewness(vals$PEN), kurtosis(vals$PEN)),
  PYG = c(mean(vals$PYG), var(vals$PYG), min(vals$PYG), max(vals$PYG), median(vals$PYG), skewness(vals$PYG), kurtosis(vals$PYG)),
  UYU = c(mean(vals$UYU), var(vals$UYU), min(vals$UYU), max(vals$UYU), median(vals$UYU), skewness(vals$UYU), kurtosis(vals$UYU))
)

rownames(stats) <- stats$Statistic
stats <- dplyr::select(stats, -c(Statistic))

kable(stats[, c("ARS", "BRL", "CLP", "COP", "CRC")])
```

```{r}
kable(stats[, c("DOP", "GTQ", "HNL", "MXN", "NIO")])
```

```{r}
kable(stats[, c("PEN", "PYG", "UYU")])
```

```{r}
kable(cor(dplyr::select(vals, -c(Date))))
```


Qué datos se van a utilizar

Tabla con la descripción de los datos

## Metodología

Diebold-Yilmaz

Modelo VAR

Modelo DCC-GARCH

DY 2012 y reseña de 2023

Análisis por región

Análisis entre potencias económicas (G8)

Análisis general

Análisis entre cabezas de región

## Resultados


```{r}
zoo_rets <- zoo(rets[ , -1], order.by = rets$Date)
zoo_vals <- zoo(vals[ , -1], order.by = rets$Date)

dca <- ConnectednessApproach(zoo_rets,
                            nlag=1,
                            nfore=10,
                            model='VAR',
                            connectedness='Time',
                            Connectedness_config=list(TimeConnectedness=list(generalized=TRUE)))


kable(dca$TABLE)
```

Gráficos


```{r}
dca <- ConnectednessApproach(zoo_rets,
                             nlag=1,
                             nfore=10,
                             window.size=60,
                             model='VAR',
                             connectedness='Time',                  Connectedness_config=list(TimeConnectedness=list(generalized=TRUE)))
PlotTCI(dca)
```

```{r}
PlotTO(dca)
```

```{r}
PlotFROM(dca)
```

```{r}
PlotNET(dca)
```

Índices

## Conclusiones

Conclusión sobre lo realizado

Conclusión sobre los hallazgos por región

Conclusión sobre los hallazgos por potencias económicas

Conclusión sobre los hallazgos generales

Conclusión sobre las cabezas de región

Lo que queda por hacer

